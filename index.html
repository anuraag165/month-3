<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Our 3-Month Journey</title>
  <link
    href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@400;600&family=Amatic+SC:wght@700&family=Dancing+Script:wght@700&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    /* reset & disable zoom */
    :root {
      --primary: #ff6b8b;
      --secondary: #ff8e9e;
      --accent: #ff4757;
      --light: #fff5f7;
      --dark: #333;
      --text: #555;
    }

    html,
    body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      touch-action: manipulation;
      overflow-x: hidden;
      background: linear-gradient(135deg, #fff5f7, #ffeef0);
      font-family: 'Quicksand', sans-serif;
      color: var(--text);
      -webkit-text-size-adjust: 100%;
    }

    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }

    /* ‚Äî‚Äî Flip-book container ‚Äî‚Äî */
    .book {
      position: relative;
      width: 92vw;
      height: 65vh;
      max-width: 380px;
      perspective: 2000px;
      margin-top: 20px;
      z-index: 10;
      touch-action: pan-y;
    }

    .page {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 8px 25px rgba(233, 30, 99, 0.2);
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      padding: 20px;
      backface-visibility: hidden;
      transform-origin: left center;
      transition: transform 0.7s cubic-bezier(0.18, 0.89, 0.32, 1.28), box-shadow 0.3s ease;
      overflow: hidden;
      box-sizing: border-box;
    }

    .page::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(255, 235, 238, 0.3) 0%, rgba(255, 209, 220, 0.2) 100%);
      z-index: -1;
    }

    /* stacking order */
    .page:nth-child(1) {
      z-index: 10;
    }

    .page:nth-child(2) {
      z-index: 9;
    }

    .page:nth-child(3) {
      z-index: 8;
    }

    .page:nth-child(4) {
      z-index: 7;
    }

    .page:nth-child(5) {
      z-index: 6;
    }

    .page:nth-child(6) {
      z-index: 5;
    }

    .page:nth-child(7) {
      z-index: 4;
    }

    .page:nth-child(8) {
      z-index: 3;
    }

    .page:nth-child(9) {
      z-index: 2;
    }

    .page:nth-child(10) {
      z-index: 1;
    }

    .page.flipped {
      transform: rotateY(-180deg);
      visibility: hidden;
    }

    /* typography + animations */
    h1 {
      font-family: 'Dancing Script', cursive;
      font-size: 2.2rem;
      color: var(--accent);
      margin: 10px 0;
      text-align: center;
      animation: fadeIn 0.8s ease;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
      line-height: 1.2;
    }

    .subtitle {
      font-family: 'Amatic SC', cursive;
      font-size: 1.6rem;
      font-weight: bold;
      color: var(--secondary);
      margin-bottom: 10px;
      text-align: center;
      animation: fadeIn 1s ease;
    }

    .text-container {
      width: 100%;
      flex: 1;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      padding: 0 5px;
      margin: 5px 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .text {
      font-size: 1rem;
      line-height: 1.7;
      color: var(--text);
      text-align: center;
      margin: 5px 0;
      animation: fadeIn 1.2s ease;
      padding: 0 5px;
    }

    .ilove {
      font-family: 'Pacifico', cursive;
      font-size: 1.8rem;
      color: var(--accent);
      margin: 15px 0;
      animation: beat 1s infinite, fadeIn 1.4s ease;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(15px)
      }

      to {
        opacity: 1;
        transform: translateY(0)
      }
    }

    @keyframes beat {

      0%,
      100% {
        transform: scale(1)
      }

      50% {
        transform: scale(1.1)
      }
    }

    /* couple avatar */
    .couple-avatar {
      width: 160px;
      height: 160px;
      margin: 10px 0;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .avatar {
      width: 70px;
      height: 70px;
      background: #ffe0b2;
      border-radius: 50%;
      border: 3px solid #ffab91;
      position: relative;
      animation: fadeIn 1.2s ease;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
    }

    .avatar.male {
      margin-right: -12px;
      z-index: 2;
    }

    .avatar.female {
      margin-left: -12px;
      background: #ffcdd2;
      border-color: #f48fb1;
    }

    .eye {
      width: 10px;
      height: 10px;
      background: #333;
      border-radius: 50%;
      position: absolute;
      top: 25px;
      animation: blink 5s infinite;
    }

    .eye.left {
      left: 15px
    }

    .eye.right {
      right: 15px
    }

    .smile {
      width: 35px;
      height: 18px;
      border-bottom: 3px solid #d84315;
      border-radius: 0 0 50px 50px;
      position: absolute;
      bottom: 18px;
    }

    .heart-between {
      position: absolute;
      color: var(--accent);
      font-size: 1.8em;
      z-index: 3;
      animation: float 3s ease-in-out infinite;
    }

    @keyframes blink {

      0%,
      20%,
      40%,
      60%,
      80%,
      100% {
        height: 10px
      }

      10%,
      30%,
      50%,
      70%,
      90% {
        height: 2px
      }
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0) scale(1)
      }

      50% {
        transform: translateY(-8px) scale(1.1)
      }
    }

    /* navigation */
    .nav-zone {
      position: absolute;
      top: 0;
      height: 100%;
      width: 50%;
      z-index: 11;
      cursor: pointer;
    }

    .nav-zone.left {
      left: 0
    }

    .nav-zone.right {
      right: 0
    }

    .arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      font-size: 2.2rem;
      color: rgba(233, 30, 99, 0.7);
      animation: pulse 1.5s infinite;
      pointer-events: none;
    }

    .nav-zone.left .arrow {
      left: 12px
    }

    .nav-zone.right .arrow {
      right: 12px
    }

    @keyframes pulse {

      0%,
      100% {
        transform: translateY(-50%) scale(1)
      }

      50% {
        transform: translateY(-50%) scale(1.2)
      }
    }

    /* gift card */
    .gift-card {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 8px 25px rgba(233, 30, 99, 0.2);
      padding: 20px;
      text-align: center;
      width: 92vw;
      max-width: 380px;
      margin: 20px auto 40px;
      animation: slideUp 0.8s ease both;
      position: relative;
      overflow: hidden;
      z-index: 5;
    }

    .gift-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(255, 235, 238, 0.3) 0%, rgba(255, 209, 220, 0.2) 100%);
      z-index: -1;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(25px)
      }

      to {
        opacity: 1;
        transform: translateY(0)
      }
    }

    .gift-card h2 {
      font-family: 'Dancing Script', cursive;
      color: var(--accent);
      margin-bottom: 12px;
      font-size: 1.8rem;
      animation: fadeIn 1s ease;
    }

    .gift-box {
      font-size: 3.5rem;
      cursor: pointer;
      user-select: none;
      transition: all 0.3s;
      animation: fadeIn 1.2s ease, float 3s ease-in-out infinite;
      display: inline-block;
    }

    .gift-box:hover {
      transform: rotate(-12deg) scale(1.15);
      animation: none;
    }

    /* lightbox */
    #lightbox {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.3s;
      z-index: 2000;
      touch-action: manipulation;
    }

    #lightbox.open {
      visibility: visible;
      opacity: 1;
    }

    #lightbox img {
      max-width: 90vw;
      max-height: 60vh;
      border-radius: 12px;
      box-shadow: 0 8px 35px rgba(0, 0, 0, 0.6);
      animation: fadeIn 0.6s ease;
      margin-bottom: 15px;
      -webkit-touch-callout: none;
    }

    .lightbox-text {
      color: white;
      font-family: 'Dancing Script', cursive;
      font-size: 1.8rem;
      text-align: center;
      max-width: 85%;
      margin-top: 15px;
      text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
      padding: 0 10px;
    }

    /* decorative elements */
    .corner-heart {
      position: absolute;
      font-size: 2.5rem;
      color: var(--accent);
      opacity: 0.2;
    }

    .top-left {
      top: 8px;
      left: 8px
    }

    .top-right {
      top: 8px;
      right: 8px
    }

    .bottom-left {
      bottom: 8px;
      left: 8px
    }

    .bottom-right {
      bottom: 8px;
      right: 8px
    }

    /* progress dots */
    .progress-dots {
      display: flex;
      justify-content: center;
      margin: 10px 0;
      gap: 8px;
    }

    .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #ccc;
      transition: all 0.3s ease;
    }

    .dot.active {
      background: var(--accent);
      transform: scale(1.2);
    }

    /* music player */
    .music-player {
      position: fixed;
      bottom: 15px;
      right: 15px;
      width: 45px;
      height: 45px;
      background: white;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 3px 12px rgba(0, 0, 0, 0.1);
      z-index: 100;
      cursor: pointer;
      color: var(--accent);
      font-size: 1.3rem;
      animation: pulse 2s infinite;
      -webkit-tap-highlight-color: transparent;
    }

    /* floating elements */
    .flowers,
    .hearts {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }

    .petal {
      position: absolute;
      width: 12px;
      height: 12px;
      background: #ff80ab;
      border-radius: 50% 50% 0 50%;
      transform: rotate(45deg);
      opacity: 0.8;
      animation: fall linear infinite;
    }

    @keyframes fall {
      0% {
        top: -10px;
        opacity: 1
      }

      100% {
        top: 110vh;
        opacity: 0
      }
    }

    .heart {
      position: absolute;
      width: 16px;
      height: 16px;
      background: var(--accent);
      transform: rotate(45deg);
      opacity: 0.7;
      animation: floatUp ease-in-out infinite;
    }

    .heart::before,
    .heart::after {
      content: '';
      position: absolute;
      width: 16px;
      height: 16px;
      background: var(--accent);
      border-radius: 50%;
    }

    .heart::before {
      top: -8px;
      left: 0
    }

    .heart::after {
      left: -8px;
      top: 0
    }

    @keyframes floatUp {
      0% {
        bottom: -20px;
        opacity: 0.8;
        transform: translateX(0) rotate(45deg)
      }

      50% {
        opacity: 1
      }

      100% {
        bottom: 110vh;
        transform: translateX(40px) rotate(45deg);
        opacity: 0
      }
    }

    /* memory gallery */
    .memory-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
      margin: 10px 0;
      width: 100%;
    }

    .memory-item {
      width: 100%;
      height: 0;
      padding-bottom: 100%;
      border-radius: 8px;
      overflow: hidden;
      position: relative;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease;
    }

    .memory-item:hover {
      transform: scale(1.03);
    }

    .memory-item img {
      position: absolute;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* icons */
    .page-icon {
      font-size: 2.8rem;
      color: var(--accent);
      margin: 10px 0;
      animation: float 3s ease-in-out infinite;
    }

    /* confetti */
    .confetti {
      position: absolute;
      width: 8px;
      height: 8px;
      background: var(--accent);
      opacity: 0;
      pointer-events: none;
    }

    /* scrollbar for text */
    .text-container::-webkit-scrollbar {
      width: 4px;
    }

    .text-container::-webkit-scrollbar-track {
      background: rgba(255, 107, 139, 0.1);
      border-radius: 2px;
    }

    .text-container::-webkit-scrollbar-thumb {
      background: rgba(255, 107, 139, 0.3);
      border-radius: 2px;
    }

    /* very small screens */
    @media (max-height: 600px) {
      .book {
        height: 60vh;
      }

      h1 {
        font-size: 1.8rem;
        margin: 5px 0;
      }

      .subtitle {
        font-size: 1.4rem;
        margin-bottom: 8px;
      }

      .text {
        font-size: 0.9rem;
      }

      .couple-avatar {
        width: 130px;
        height: 130px;
        margin: 8px 0;
      }

      .avatar {
        width: 60px;
        height: 60px;
      }
    }
  </style>
</head>

<body>

  <!-- Flip-book -->
  <div class="book" id="book">
    <!-- navigation zones -->
    <div class="nav-zone left"><span class="arrow">‚ùÆ</span></div>
    <div class="nav-zone right"><span class="arrow">‚ùØ</span></div>

    <div class="page">
      <div class="corner-heart top-left">‚ù§Ô∏è</div>
      <div class="corner-heart top-right">‚ù§Ô∏è</div>
      <div class="corner-heart bottom-left">‚ù§Ô∏è</div>
      <div class="corner-heart bottom-right">‚ù§Ô∏è</div>

      <h1>Our 3-Month Journey</h1>
      <p class="subtitle">For My Beloved Raveena</p>

      <div class="couple-avatar">
        <div class="avatar male">
          <div class="eye left"></div>
          <div class="eye right"></div>
          <div class="smile"></div>
        </div>
        <div class="heart-between">‚ù§Ô∏è</div>
        <div class="avatar female">
          <div class="eye left"></div>
          <div class="eye right"></div>
          <div class="smile"></div>
        </div>
      </div>

      <div class="text-container">
        <p class="text">Every moment with you has been more magical than I could have ever imagined</p>
      </div>
    </div>

    <div class="page">
      <h1>Chapter 1</h1>
      <p class="subtitle">21st February - My Favorite Day</p>
      <i class="fas fa-calendar-day page-icon"></i>
      <div class="memory-grid">
        <div class="memory-item" style="background: #ffcdd2;"></div>
        <div class="memory-item" style="background: #f8bbd0;"></div>
        <div class="memory-item" style="background: #f48fb1;"></div>
        <div class="memory-item" style="background: #f06292;"></div>
      </div>
    </div>

    <div class="page">
      <h1>Chapter 1</h1>
      <p class="subtitle">The Beginning of Us</p>
      <div class="text-container">
        <p class="text">
          The day I first saw you, heard your voice, and met you - 21st February became my favorite day. I didn't know
          then that you'd become my favorite person in the world.
        </p>
        <p class="text">
          I quickly came to know how much you love flowers, and how sweet and cute you truly are. Our phone calls were
          so special, and meeting every day for lunch became the highlight of my days.
        </p>
      </div>
      <div class="progress-dots">
        <div class="dot"></div>
        <div class="dot active"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
    </div>

    <div class="page">
      <h1>Chapter 2</h1>
      <p class="subtitle">Growing Through Challenges</p>
      <i class="fas fa-heart page-icon" style="animation: beat 1s infinite, float 3s ease-in-out infinite;"></i>
      <div class="memory-grid">
        <div class="memory-item" style="background: #e1bee7;"></div>
        <div class="memory-item" style="background: #ce93d8;"></div>
        <div class="memory-item" style="background: #ba68c8;"></div>
        <div class="memory-item" style="background: #ab47bc;"></div>
      </div>
    </div>

    <div class="page">
      <h1>Chapter 2</h1>
      <p class="subtitle">Our Special Moments</p>
      <div class="text-container">
        <p class="text">
          I was insecure and made many mistakes, but I'm so glad I never gave up on us. I'm learning every day, and the
          most important thing to me is making you smile.
        </p>
        <p class="text">
          I know giving you flowers makes you happy, and that joy lights up my entire day. You're absolutely adorable -
          I loved how you'd take those 3kg dumbbells at the gym and exercise like the princess you are. Every little
          thing you do makes me fall for you more.
        </p>
      </div>
      <div class="progress-dots">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot active"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
    </div>

    <div class="page">
      <h1>Chapter 3</h1>
      <p class="subtitle">Stronger Together</p>
      <i class="fas fa-hands-helping page-icon"></i>
      <div class="text-container">
        <p class="text">
          We've learned so much through our mistakes. I understand you're busy with your studies, and I completely
          support you. I'll always be here for you, my cutie.
        </p>
        <p class="text">
          I promise I'll never give up on us. I'll always be your friend, always listen to you, and we'll communicate
          through everything. Any problem you have isn't just yours - it's mine too, and we'll fix it together because
          that's what love means to me.
        </p>
      </div>
      <div class="progress-dots">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot active"></div>
        <div class="dot"></div>
      </div>
    </div>

    <div class="page">
      <h1>Chapter 4</h1>
      <p class="subtitle">Dreaming of Our Future</p>
      <i class="fas fa-star page-icon"></i>
      <div class="text-container">
        <p class="text">
          I dream of a lifetime with you - laughing together, supporting each other's dreams, and growing old side by
          side. Every single moment with you has been special, and I cherish them all.
        </p>
        <p class="text">
          Thank you for being you, for your patience, and for letting me be part of your life. I promise to keep
          bringing you flowers, to keep making you smile, and to love you more each day.
        </p>
        <p class="ilove">I love you endlessly ‚ù§Ô∏è</p>
      </div>
      <div class="progress-dots">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot active"></div>
      </div>
    </div>

    <div class="page">
      <h1>Surprise!</h1>
      <p class="subtitle">Tap the gift box below</p>
      <div class="gift-box" onclick="openLightbox()">üéÅ</div>
      <p style="margin-top: 15px; font-size: 0.9em;">(Make sure your sound is on!)</p>
    </div>
  </div>

  <!-- floating petals & hearts -->
  <div class="flowers"></div>
  <div class="hearts"></div>

  <!-- gift-card below -->
  <div class="gift-card">
    <h2>Open Your Special Gift</h2>
    <div class="gift-box" onclick="openLightbox()">üéÅ</div>
    <p style="margin-top: 12px; font-size: 0.9em;">Click the gift to reveal your surprise</p>
  </div>

  <!-- music player -->
  <div class="music-player" id="musicToggle">
    <i class="fas fa-music"></i>
  </div>

  <!-- lightbox + audio -->
  <div id="lightbox" onclick="closeLightbox()">
    <img src="img.png" alt="Special Surprise">
    <div class="lightbox-text">To My Beautiful Raveena ‚ù§Ô∏è</div>
  </div>

  <audio id="giftAudio" loop>
    <source src="song.mp3" type="audio/mpeg">
  </audio>

  <script>
    const pages = Array.from(document.querySelectorAll('.page'));
    let idx = 0;
    const audio = document.getElementById('giftAudio');
    const lb = document.getElementById('lightbox');
    const leftZone = document.querySelector('.nav-zone.left');
    const rightZone = document.querySelector('.nav-zone.right');
    const dots = document.querySelectorAll('.dot');
    const musicToggle = document.getElementById('musicToggle');
    let isMusicPlaying = false;

    // Initialize first dot as active
    dots[0].classList.add('active');

    function flipNext() {
      if (idx < pages.length - 1) {
        pages[idx].classList.add('flipped');
        idx++;
        updateDots();
      }
    }

    function flipPrev() {
      if (idx > 0) {
        idx--;
        pages[idx].classList.remove('flipped');
        updateDots();
      }
    }

    function updateDots() {
      dots.forEach((dot, i) => {
        dot.classList.toggle('active', i === idx);
      });
    }

    rightZone.addEventListener('click', flipNext);
    leftZone.addEventListener('click', flipPrev);

    // Improved swipe support
    let startX = 0;
    let isSwiping = false;
    const book = document.getElementById('book');
    const threshold = 30;

    book.addEventListener('touchstart', e => {
      startX = e.touches[0].clientX;
      isSwiping = true;
    }, { passive: true });

    book.addEventListener('touchmove', e => {
      if (!isSwiping) return;
      const currentX = e.touches[0].clientX;
      const diff = currentX - startX;

      // Prevent vertical scrolling during horizontal swipe
      if (Math.abs(diff) > 10) {
        e.preventDefault();
      }
    }, { passive: false });

    book.addEventListener('touchend', e => {
      if (!isSwiping) return;
      isSwiping = false;

      const endX = e.changedTouches[0].clientX;
      const diff = endX - startX;

      if (diff < -threshold) flipNext();
      if (diff > threshold) flipPrev();
    }, { passive: true });

    function openLightbox() {
      lb.classList.add('open');
      // Start playing at 61 seconds (1:01)
      audio.currentTime = 61;
      audio.play().catch(e => {
        console.log('Audio play failed:', e);
        alert('Please tap "OK" then try opening the gift again');
      });
      createConfetti();
      isMusicPlaying = true;
      musicToggle.innerHTML = '<i class="fas fa-pause"></i>';
    }

    function closeLightbox() {
      lb.classList.remove('open');
      audio.pause();
    }

    // music toggle with better mobile handling
    musicToggle.addEventListener('click', function () {
      if (isMusicPlaying) {
        audio.pause();
        musicToggle.innerHTML = '<i class="fas fa-music"></i>';
      } else {
        audio.play().then(() => {
          musicToggle.innerHTML = '<i class="fas fa-pause"></i>';
        }).catch(e => {
          console.log('Audio play failed:', e);
          alert('Please tap the gift box first to enable music');
        });
      }
      isMusicPlaying = !isMusicPlaying;
    });

    // generate petals & hearts with optimized mobile performance
    function createFloatingElements() {
      const flowersContainer = document.querySelector('.flowers');
      const heartsContainer = document.querySelector('.hearts');

      // Clear existing
      flowersContainer.innerHTML = '';
      heartsContainer.innerHTML = '';

      // Create petals (reduced quantity for mobile)
      for (let i = 0; i < 25; i++) {
        const p = document.createElement('div');
        p.className = 'petal';
        p.style.left = Math.random() * 100 + 'vw';
        p.style.animationDuration = (3 + Math.random() * 3) + 's';
        p.style.animationDelay = Math.random() * 2 + 's';
        p.style.opacity = Math.random() * 0.4 + 0.3;
        p.style.background = `hsl(${Math.random() * 30 + 330}, 100%, 75%)`;
        flowersContainer.appendChild(p);
      }

      // Create hearts (reduced quantity for mobile)
      for (let i = 0; i < 20; i++) {
        const h = document.createElement('div');
        h.className = 'heart';
        h.style.left = Math.random() * 100 + 'vw';
        h.style.animationDuration = (2 + Math.random() * 2) + 's';
        h.style.animationDelay = Math.random() * 1 + 's';
        h.style.opacity = Math.random() * 0.4 + 0.3;
        heartsContainer.appendChild(h);
      }
    }

    // create confetti explosion with optimized mobile performance
    function createConfetti() {
      const colors = ['#ff6b8b', '#ff8e9e', '#ff4757', '#ffb8c6', '#ff9eb5'];
      const container = document.createElement('div');
      container.style.position = 'fixed';
      container.style.top = '0';
      container.style.left = '0';
      container.style.width = '100%';
      container.style.height = '100%';
      container.style.pointerEvents = 'none';
      container.style.zIndex = '2001';
      document.body.appendChild(container);

      // Limit to 50 pieces for mobile performance
      for (let i = 0; i < 50; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = Math.random() * 100 + 'vw';
        confetti.style.top = Math.random() * 20 + 'vh';
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
        confetti.style.width = Math.random() * 8 + 4 + 'px';
        confetti.style.height = Math.random() * 8 + 4 + 'px';
        confetti.style.opacity = '1';

        container.appendChild(confetti);

        const animationDuration = Math.random() * 2 + 1.5;
        confetti.style.animation = `confettiFall ${animationDuration}s linear forwards`;

        // Remove after animation
        setTimeout(() => {
          confetti.remove();
        }, animationDuration * 1000);
      }

      // Add keyframes
      const style = document.createElement('style');
      style.innerHTML = `
        @keyframes confettiFall {
          0% {
            transform: translateY(-20vh) rotate(0deg);
            opacity: 1;
          }
          100% {
            transform: translateY(100vh) rotate(${Math.random() * 360}deg);
            opacity: 0;
          }
        }
      `;
      document.head.appendChild(style);

      // Clean up
      setTimeout(() => {
        container.remove();
        style.remove();
      }, 2000);
    }

    // Initialize floating elements
    createFloatingElements();

    // Add decorative elements to pages (fewer for mobile)
    pages.forEach(page => {
      if (Math.random() > 0.5) {
        const deco = document.createElement('div');
        deco.className = 'page-decoration';
        deco.style.width = Math.random() * 80 + 40 + 'px';
        deco.style.height = Math.random() * 80 + 40 + 'px';
        deco.style.background = `radial-gradient(circle, rgba(255,107,139,0.1) 0%, rgba(255,107,139,0) 70%)`;
        deco.style.top = Math.random() * 80 + 10 + '%';
        deco.style.left = Math.random() * 80 + 10 + '%';
        page.appendChild(deco);
      }
    });

    // Better mobile viewport handling
    function adjustViewport() {
      const vh = window.innerHeight * 0.01;
      document.documentElement.style.setProperty('--vh', `${vh}px`);

      // Adjust book height based on screen
      const book = document.querySelector('.book');
      if (window.innerHeight < 600) {
        book.style.height = '55vh';
      } else {
        book.style.height = '65vh';
      }
    }

    window.addEventListener('resize', adjustViewport);
    window.addEventListener('orientationchange', adjustViewport);
    adjustViewport();

    // Ensure all pages are properly aligned
    function checkPageContentFit() {
      pages.forEach(page => {
        const textContainer = page.querySelector('.text-container');
        if (textContainer) {
          const contentHeight = textContainer.scrollHeight;
          const containerHeight = textContainer.clientHeight;

          if (contentHeight > containerHeight) {
            textContainer.style.justifyContent = 'flex-start';
          } else {
            textContainer.style.justifyContent = 'center';
          }
        }
      });
    }

    // Run check after short delay to allow rendering
    setTimeout(checkPageContentFit, 300);
  </script>
</body>

</html>